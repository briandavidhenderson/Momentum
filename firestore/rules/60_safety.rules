    // ============================================================================
    // RISK ASSESSMENTS (Safety - Phase 3)
    // ============================================================================
    match /riskAssessments/{assessmentId} {
      allow read: if isAuthenticated() && (resource.data.labId == getUserLab() || isAdmin());
      allow create: if isAuthenticated() && request.resource.data.createdBy == request.auth.uid;
      allow update: if isAuthenticated() && (resource.data.labId == getUserLab() || isAdmin());
      allow delete: if isAuthenticated() && (resource.data.labId == getUserLab() || isAdmin());
    }

    // ============================================================================
    // INCIDENTS (Safety - Phase 3)
    // ============================================================================
    match /incidents/{incidentId} {
      allow read: if isAuthenticated() && (resource.data.labId == getUserLab() || isAdmin());
      allow create: if isAuthenticated() && request.resource.data.reportedBy == request.auth.uid;
      allow update: if isAuthenticated() && (resource.data.labId == getUserLab() || isAdmin());
      allow delete: if isAuthenticated() && (resource.data.labId == getUserLab() || isAdmin());
    }
