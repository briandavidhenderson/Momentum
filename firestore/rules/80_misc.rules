    // ============================================================================
    // NOTIFICATIONS
    // ============================================================================
    match /notifications/{notificationId} {
      // Users can read their own notifications
      allow read: if isAuthenticated() && resource.data.userId == request.auth.uid;

      // System and authenticated users can create notifications
      allow create: if isAuthenticated();

      // Users can update their own notifications (mark as read)
      allow update: if isAuthenticated() && resource.data.userId == request.auth.uid;

      // Users can delete their own notifications
      allow delete: if isAuthenticated() && resource.data.userId == request.auth.uid;
    }

    // ============================================================================
    // AI GENERATED CONTENT (GDPR/EU AI Act Compliance)
    // ============================================================================
    match /aiGeneratedContent/{contentId} {
      // Users can read AI content records they created
      allow read: if isAuthenticated() && resource.data.generatedBy == request.auth.uid;

      // Users can create AI content records
      allow create: if isAuthenticated() && request.resource.data.generatedBy == request.auth.uid;

      // No updates or deletes (audit trail for compliance)
      allow update, delete: if false;
    }

    // ============================================================================
    // SAMPLES (Sample Genealogy - Phase 4)
    // ============================================================================
    match /samples/{sampleId} {
      allow read: if isAuthenticated() && (resource.data.labId == getUserLab() || isAdmin());
      allow create: if isAuthenticated() && request.resource.data.createdBy == request.auth.uid;
      allow update: if isAuthenticated() && (resource.data.labId == getUserLab() || isAdmin());
      allow delete: if isAuthenticated() && (resource.data.labId == getUserLab() || isAdmin());
    }

    // ============================================================================
    // STORAGE LOCATIONS (Sample Management - Phase 6)
    // ============================================================================
    match /storageLocations/{locationId} {
      allow read: if isAuthenticated() && (resource.data.labId == getUserLab() || isAdmin());
      allow create: if isAuthenticated() && request.resource.data.createdBy == request.auth.uid;
      allow update: if isAuthenticated() && (resource.data.labId == getUserLab() || isAdmin());
      allow delete: if isAuthenticated() && (resource.data.labId == getUserLab() || isAdmin());
    }

    // ============================================================================
    // ORCID RECORDS
    // ============================================================================
    match /orcidRecords/{orcidId} {
      // Allow read for authenticated users
      allow read: if isAuthenticated();

      // Allow create/update if authenticated
      // Ideally we should check if the user claims this ORCID, but for now allow authenticated writes
      allow write: if isAuthenticated();
    }

    // ============================================================================
    // AUDIT TRAILS
    // ============================================================================
    match /auditTrails/{auditId} {
      // Readable by authenticated users (used in Right Info Panel)
      allow read: if isAuthenticated();
      // Create-only endpoint; no updates or deletes by regular users
      allow create: if isAuthenticated();
      allow update: if isAdmin();
      allow delete: if isAdmin();
    }
